<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesticide Management - SmartFarm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .pesticide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .pesticide-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #e74c3c;
            transition: transform 0.3s ease;
        }

        .pesticide-card:hover {
            transform: translateY(-5px);
        }

        .pesticide-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .pesticide-details {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        /* Professional Modal Styles */
        .pesticide-info-card, .pesticide-targets-card, .safety-guidelines-card, .application-info-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .pesticide-category-card, .pest-category-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .pesticide-list, .pest-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .pesticide-item, .pest-item {
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid #007bff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .pesticide-item:hover, .pest-item:hover {
            transform: translateX(5px);
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .info-item {
            padding: 8px 12px;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #007bff;
            font-size: 0.9rem;
        }

        .target-list, .safety-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .target-list li, .safety-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
        }

        .target-list li:last-child, .safety-list li:last-child {
            border-bottom: none;
        }

        .application-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .detail-item {
            padding: 10px;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #17a2b8;
            font-size: 0.9rem;
        }

        .effectiveness-bar {
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .effectiveness-fill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c, #f39c12);
            border-radius: 4px;
        }

        .pest-matching-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .pest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .pest-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #28a745;
        }

        .pest-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .recommended-pesticides {
            font-size: 0.9rem;
            color: #666;
        }

        .btn-custom {
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .alert-custom {
            border-radius: 15px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .metric-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1><i class="fas fa-bug me-3"></i>Pesticide Management System</h1>
            <p class="mb-0">Comprehensive pesticide database with detailed chemical information and safety guidelines</p>
        </div>

        <!-- Statistics Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">4+</div>
                <div class="stat-label">Pesticide Categories</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">15+</div>
                <div class="stat-label">Target Pests</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">95%</div>
                <div class="stat-label">Max Effectiveness</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">100%</div>
                <div class="stat-label">Safety Compliance</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="row mb-4">
            <div class="col-md-3">
                <button class="btn btn-primary btn-custom w-100" onclick="viewAllPesticides()">
                    <i class="fas fa-list me-2"></i>View All Pesticides
                </button>
            </div>
            <div class="col-md-3">
                <button class="btn btn-success btn-custom w-100" onclick="identifyPest()">
                    <i class="fas fa-search me-2"></i>Identify Pest
                </button>
            </div>
            <div class="col-md-3">
                <button class="btn btn-warning btn-custom w-100" onclick="checkWeatherConditions()">
                    <i class="fas fa-cloud-sun me-2"></i>Weather Check
                </button>
            </div>
            <div class="col-md-3">
                <button class="btn btn-info btn-custom w-100" onclick="viewApplicationHistory()">
                    <i class="fas fa-history me-2"></i>Application History
                </button>
            </div>
        </div>

        <!-- Pesticide Database Section -->
        <div class="row">
            <div class="col-12">
                <h3 class="mb-4"><i class="fas fa-database me-2"></i>Pesticide Database</h3>
                
                <div class="pesticide-grid">
                    <!-- Malathion -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Malathion</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Organophosphate Insecticide<br>
                            <strong>Target:</strong> Aphids, Whiteflies, Thrips<br>
                            <strong>Cost:</strong> $35.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 85%"></div>
                        </div>
                        <small class="text-muted">85% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-primary w-100 mt-2" onclick="selectPesticide('Malathion')">
                            <i class="fas fa-bug me-1"></i>Select Pesticide
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Malathion')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Deltamethrin -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Deltamethrin</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Pyrethroid Insecticide<br>
                            <strong>Target:</strong> Caterpillars, Beetles, Thrips<br>
                            <strong>Cost:</strong> $45.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 95%"></div>
                        </div>
                        <small class="text-muted">95% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-primary w-100 mt-2" onclick="selectPesticide('Deltamethrin')">
                            <i class="fas fa-bug me-1"></i>Select Pesticide
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Deltamethrin')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Neem Oil -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Neem Oil</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Organic Insecticide<br>
                            <strong>Target:</strong> Aphids, Whiteflies, Spider Mites<br>
                            <strong>Cost:</strong> $15.00/L<br>
                            <strong>Safety:</strong> High
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 75%"></div>
                        </div>
                        <small class="text-muted">75% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-success w-100 mt-2" onclick="selectPesticide('Neem Oil')">
                            <i class="fas fa-leaf me-1"></i>Select Organic
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Neem Oil')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Insecticidal Soap -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Insecticidal Soap</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Organic Insecticide<br>
                            <strong>Target:</strong> Soft-bodied insects<br>
                            <strong>Cost:</strong> $8.00/L<br>
                            <strong>Safety:</strong> Very High
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 70%"></div>
                        </div>
                        <small class="text-muted">70% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-success w-100 mt-2" onclick="selectPesticide('Insecticidal Soap')">
                            <i class="fas fa-leaf me-1"></i>Select Organic
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Insecticidal Soap')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Imidacloprid -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Imidacloprid</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Neonicotinoid<br>
                            <strong>Target:</strong> Aphids, Whiteflies, Thrips<br>
                            <strong>Cost:</strong> $55.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 90%"></div>
                        </div>
                        <small class="text-muted">90% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-warning w-100 mt-2" onclick="selectPesticide('Imidacloprid')">
                            <i class="fas fa-bug me-1"></i>Select Systemic
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Imidacloprid')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Spinosad -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Spinosad</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Natural Insecticide<br>
                            <strong>Target:</strong> Caterpillars, Thrips, Beetles<br>
                            <strong>Cost:</strong> $40.00/L<br>
                            <strong>Safety:</strong> High
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 85%"></div>
                        </div>
                        <small class="text-muted">85% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-success w-100 mt-2" onclick="selectPesticide('Spinosad')">
                            <i class="fas fa-seedling me-1"></i>Select Natural
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Spinosad')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Bacillus thuringiensis -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Bacillus thuringiensis</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Biological Insecticide<br>
                            <strong>Target:</strong> Caterpillars, Larvae<br>
                            <strong>Cost:</strong> $25.00/L<br>
                            <strong>Safety:</strong> Very High
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 80%"></div>
                        </div>
                        <small class="text-muted">80% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="selectPesticide('Bacillus thuringiensis')">
                            <i class="fas fa-bacteria me-1"></i>Select Biological
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Bacillus thuringiensis')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Mancozeb -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Mancozeb</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Dithiocarbamate Fungicide<br>
                            <strong>Target:</strong> Powdery Mildew, Leaf Spot, Rust<br>
                            <strong>Cost:</strong> $30.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 85%"></div>
                        </div>
                        <small class="text-muted">85% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-secondary w-100 mt-2" onclick="selectPesticide('Mancozeb')">
                            <i class="fas fa-shield-alt me-1"></i>Select Fungicide
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Mancozeb')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Propiconazole -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Propiconazole</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Triazole Systemic Fungicide<br>
                            <strong>Target:</strong> Powdery Mildew, Rust, Anthracnose<br>
                            <strong>Cost:</strong> $50.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 90%"></div>
                        </div>
                        <small class="text-muted">90% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-warning w-100 mt-2" onclick="selectPesticide('Propiconazole')">
                            <i class="fas fa-virus me-1"></i>Select Systemic
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Propiconazole')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Chlorothalonil -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Chlorothalonil</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Chloronitrile Protectant<br>
                            <strong>Target:</strong> Leaf Spot, Blight, Anthracnose<br>
                            <strong>Cost:</strong> $35.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 80%"></div>
                        </div>
                        <small class="text-muted">80% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-secondary w-100 mt-2" onclick="selectPesticide('Chlorothalonil')">
                            <i class="fas fa-shield-virus me-1"></i>Select Protectant
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Chlorothalonil')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Copper Compounds -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Copper Compounds</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Inorganic Bactericide<br>
                            <strong>Target:</strong> Bacterial & Fungal Diseases<br>
                            <strong>Cost:</strong> $20.00/L<br>
                            <strong>Safety:</strong> Moderate
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 75%"></div>
                        </div>
                        <small class="text-muted">75% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-primary w-100 mt-2" onclick="selectPesticide('Copper Compounds')">
                            <i class="fas fa-bacteria me-1"></i>Select Bactericide
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Copper Compounds')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>

                    <!-- Streptomycin -->
                    <div class="pesticide-card">
                        <div class="pesticide-name">Streptomycin</div>
                        <div class="pesticide-details">
                            <strong>Type:</strong> Antibiotic Bactericide<br>
                            <strong>Target:</strong> Fire Blight, Bacterial Spot<br>
                            <strong>Cost:</strong> $60.00/L<br>
                            <strong>Safety:</strong> High
                        </div>
                        <div class="effectiveness-bar">
                            <div class="effectiveness-fill" style="width: 85%"></div>
                        </div>
                        <small class="text-muted">85% Effectiveness</small>
                        <button class="btn btn-sm btn-outline-primary w-100 mt-2" onclick="selectPesticide('Streptomycin')">
                            <i class="fas fa-pills me-1"></i>Select Antibiotic
                        </button>
                        <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="showPesticideDetails('Streptomycin')">
                            <i class="fas fa-info-circle me-1"></i>View Details
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pest-Pesticide Matching Section -->
        <div class="pest-matching-section">
            <h3 class="mb-4"><i class="fas fa-crosshairs me-2"></i>Pest-Pesticide Matching</h3>
            
            <div class="pest-grid">
                <div class="pest-card">
                    <div class="pest-name">Aphids</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Malathion<br>
                        • Deltamethrin<br>
                        • Imidacloprid<br>
                        • Neem Oil<br>
                        • Insecticidal Soap
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Whiteflies</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Malathion<br>
                        • Deltamethrin<br>
                        • Imidacloprid<br>
                        • Neem Oil<br>
                        • Insecticidal Soap
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Spider Mites</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Malathion<br>
                        • Neem Oil<br>
                        • Insecticidal Soap
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Thrips</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Malathion<br>
                        • Deltamethrin<br>
                        • Imidacloprid<br>
                        • Spinosad<br>
                        • Neem Oil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Caterpillars</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Deltamethrin<br>
                        • Spinosad<br>
                        • Bacillus thuringiensis<br>
                        • Neem Oil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Beetles</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Deltamethrin<br>
                        • Imidacloprid<br>
                        • Spinosad<br>
                        • Neem Oil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Powdery Mildew</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Mancozeb<br>
                        • Propiconazole<br>
                        • Chlorothalonil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Leaf Spot</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Mancozeb<br>
                        • Propiconazole<br>
                        • Chlorothalonil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Rust</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Mancozeb<br>
                        • Propiconazole<br>
                        • Chlorothalonil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Anthracnose</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Propiconazole<br>
                        • Chlorothalonil
                    </div>
                </div>

                <div class="pest-card">
                    <div class="pest-name">Blight</div>
                    <div class="recommended-pesticides">
                        <strong>Recommended:</strong><br>
                        • Mancozeb<br>
                        • Chlorothalonil
                    </div>
                </div>

            </div>
        </div>

        <!-- Safety Alerts -->
        <div class="alert alert-warning alert-custom">
            <h5><i class="fas fa-exclamation-triangle me-2"></i>Safety Reminders</h5>
            <ul class="mb-0">
                <li>Always wear appropriate protective equipment when handling pesticides</li>
                <li>Check weather conditions before application (no rain for 4-6 hours)</li>
                <li>Follow pre-harvest intervals to ensure food safety</li>
                <li>Store pesticides in secure, labeled containers away from children</li>
                <li>Rotate pesticides to prevent resistance development</li>
            </ul>
        </div>

        <!-- Navigation -->
        <div class="text-center mt-4">
            <a href="dashboard.html" class="btn btn-outline-primary btn-custom me-3">
                <i class="fas fa-tachometer-alt me-2"></i>Back to Dashboard
            </a>
            <a href="weeding-management.html" class="btn btn-outline-success btn-custom">
                <i class="fas fa-seedling me-2"></i>Weeding Management
            </a>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Pesticide Management System -->
    <script src="js/pesticide-management.js"></script>
    
    <script>
        // Check authentication
        function checkAuthentication() {
            const user = localStorage.getItem('smartfarm_user') || sessionStorage.getItem('smartfarm_user');
            const token = localStorage.getItem('smartfarm_token') || sessionStorage.getItem('smartfarm_token');
            
            if (!user) {
                console.log('No user found, redirecting to login');
                window.location.href = 'login.html';
                return;
            }
            
            // Check if session is still valid (for non-remember me users)
            const loginTime = localStorage.getItem('smartfarm_login_time') || sessionStorage.getItem('smartfarm_login_time');
            const rememberMe = localStorage.getItem('smartfarm_remember_me') === 'true';
            
            if (!rememberMe && loginTime) {
                const now = new Date().getTime();
                const login = new Date(loginTime).getTime();
                const hoursDiff = (now - login) / (1000 * 60 * 60);
                
                // Session expires after 24 hours for non-remember me users
                if (hoursDiff > 24) {
                    console.log('Session expired, redirecting to login');
                    localStorage.removeItem('smartfarm_user');
                    localStorage.removeItem('smartfarm_token');
                    localStorage.removeItem('smartfarm_login_time');
                    sessionStorage.removeItem('smartfarm_user');
                    sessionStorage.removeItem('smartfarm_token');
                    sessionStorage.removeItem('smartfarm_login_time');
                    window.location.href = 'login.html';
                    return;
                }
            }
            
            console.log('Authentication successful for:', user);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
            populatePesticideData();
        });

        function populatePesticideData() {
            // This would populate the page with data from the pesticide management system
            console.log('Pesticide Management System initialized');
        }

        // Professional Dialog System
        function showInfoDialog(title, message, buttonText = 'OK', callback = null) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-info text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-info-circle me-2"></i>${title}
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div style="white-space: pre-line;">${message}</div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-info" data-bs-dismiss="modal">${buttonText}</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
                if (callback) callback();
            });
        }

        function showSuccessDialog(title, message, buttonText = 'OK', callback = null) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-success text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-check-circle me-2"></i>${title}
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div style="white-space: pre-line;">${message}</div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-success" data-bs-dismiss="modal">${buttonText}</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
                if (callback) callback();
            });
        }

        function showWarningDialog(title, message, buttonText = 'OK', callback = null) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-warning text-dark">
                            <h5 class="modal-title">
                                <i class="fas fa-exclamation-triangle me-2"></i>${title}
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div style="white-space: pre-line;">${message}</div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-warning" data-bs-dismiss="modal">${buttonText}</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
                if (callback) callback();
            });
        }

        function showErrorMessage(message, title = 'Error') {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-danger text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-exclamation-triangle me-2"></i>${title}
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div style="white-space: pre-line;">${message}</div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        function viewAllPesticides() {
            showProfessionalPesticideDatabaseModal();
        }

        function showProfessionalPesticideDatabaseModal() {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-xl modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-list me-2"></i>Complete Pesticide Database
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="pesticide-category-card">
                                        <h6 class="text-danger mb-3">
                                            <i class="fas fa-bug me-2"></i>Insecticides
                                        </h6>
                                        <div class="pesticide-list">
                                            <div class="pesticide-item">
                                                <strong>Malathion</strong> - Organophosphate
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Deltamethrin</strong> - Pyrethroid
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Neem Oil</strong> - Organic
                                                <span class="badge bg-success ms-2">High Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Insecticidal Soap</strong> - Organic
                                                <span class="badge bg-success ms-2">Very High Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Imidacloprid</strong> - Neonicotinoid
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Spinosad</strong> - Natural
                                                <span class="badge bg-success ms-2">High Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Bacillus thuringiensis</strong> - Biological
                                                <span class="badge bg-success ms-2">Very High Safety</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pesticide-category-card">
                                        <h6 class="text-info mb-3">
                                            <i class="fas fa-shield-virus me-2"></i>Fungicides & Bactericides
                                        </h6>
                                        <div class="pesticide-list">
                                            <div class="pesticide-item">
                                                <strong>Mancozeb</strong> - Dithiocarbamate
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Propiconazole</strong> - Systemic
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Chlorothalonil</strong> - Protectant
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Copper Compounds</strong> - Bactericide
                                                <span class="badge bg-warning ms-2">Moderate Safety</span>
                                            </div>
                                            <div class="pesticide-item">
                                                <strong>Streptomycin</strong> - Antibiotic
                                                <span class="badge bg-warning ms-2">High Safety</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-lightbulb me-2"></i>
                                <strong>Database Features:</strong> Each pesticide includes detailed chemical information, mixture instructions, safety guidelines, application rates, and environmental impact data.
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="exportPesticideDatabase()">
                                <i class="fas fa-download me-1"></i>Export Database
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        function identifyPest() {
            showProfessionalPestIdentificationModal();
        }

        function showProfessionalPestIdentificationModal() {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-xl modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-success text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-search me-2"></i>Pest Identification Guide
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="pest-category-card">
                                        <h6 class="text-danger mb-3">
                                            <i class="fas fa-bug me-2"></i>Insects
                                        </h6>
                                        <div class="pest-list">
                                            <div class="pest-item">
                                                <strong>Aphids</strong>
                                                <small class="d-block text-muted">Small, soft-bodied, green/black</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Whiteflies</strong>
                                                <small class="d-block text-muted">Tiny, white, flying insects</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Spider Mites</strong>
                                                <small class="d-block text-muted">Tiny, web-spinning arachnids</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Thrips</strong>
                                                <small class="d-block text-muted">Slender, fringed wings</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Caterpillars</strong>
                                                <small class="d-block text-muted">Larval stage, voracious eaters</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Beetles</strong>
                                                <small class="d-block text-muted">Hard-shelled, various sizes</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="pest-category-card">
                                        <h6 class="text-warning mb-3">
                                            <i class="fas fa-virus me-2"></i>Fungal Diseases
                                        </h6>
                                        <div class="pest-list">
                                            <div class="pest-item">
                                                <strong>Powdery Mildew</strong>
                                                <small class="d-block text-muted">White powdery coating on leaves</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Leaf Spot</strong>
                                                <small class="d-block text-muted">Circular brown/black spots</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Rust</strong>
                                                <small class="d-block text-muted">Orange/yellow pustules</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Blight</strong>
                                                <small class="d-block text-muted">Rapid wilting and death</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="pest-category-card">
                                        <h6 class="text-info mb-3">
                                            <i class="fas fa-bacteria me-2"></i>Bacterial Diseases
                                        </h6>
                                        <div class="pest-list">
                                            <div class="pest-item">
                                                <strong>Bacterial Blight</strong>
                                                <small class="d-block text-muted">Water-soaked lesions</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Crown Gall</strong>
                                                <small class="d-block text-muted">Swollen growths on stems</small>
                                                <span class="badge bg-warning ms-2">Medium Damage</span>
                                            </div>
                                            <div class="pest-item">
                                                <strong>Bacterial Wilt</strong>
                                                <small class="d-block text-muted">Sudden wilting, no recovery</small>
                                                <span class="badge bg-danger ms-2">High Damage</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-success mt-3">
                                <i class="fas fa-lightbulb me-2"></i>
                                <strong>Identification Tips:</strong> Use the pest-pesticide matching section below to find recommended treatments for each pest type. Early identification leads to better control results.
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-success" onclick="startPestIdentification()">
                                <i class="fas fa-search me-1"></i>Start Identification
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        async function checkWeatherConditions() {
            try {
                // Show loading state
                showInfoDialog('🌤️ Weather Check', 'Fetching current weather conditions...');
                
                // Try to get real weather data from API
                let weatherData = null;
                if (typeof window.SmartFarmAPI !== 'undefined') {
                    try {
                        const response = await window.SmartFarmAPI.getWeatherData();
                        if (response.success) {
                            weatherData = response.data;
                        }
                    } catch (apiError) {
                        console.warn('Weather API not available, using demo data:', apiError);
                    }
                }
                
                // Use demo data if API is not available
                if (!weatherData) {
                    weatherData = {
                        temperature: 25,
                        humidity: 65,
                        windSpeed: 8,
                        rainfall: 0,
                        pressure: 1013,
                        uvIndex: 6,
                        cloudCover: 30,
                        description: 'Partly Cloudy',
                        forecast: {
                            next6Hours: [
                                { hour: 0, temp: 25, humidity: 65, rain: 0, wind: 8, description: 'Partly Cloudy' },
                                { hour: 1, temp: 24, humidity: 68, rain: 0, wind: 6, description: 'Partly Cloudy' },
                                { hour: 2, temp: 23, humidity: 72, rain: 0, wind: 5, description: 'Clear' },
                                { hour: 3, temp: 22, humidity: 75, rain: 0, wind: 4, description: 'Clear' },
                                { hour: 4, temp: 21, humidity: 78, rain: 0, wind: 3, description: 'Clear' },
                                { hour: 5, temp: 20, humidity: 80, rain: 0, wind: 2, description: 'Clear' },
                                { hour: 6, temp: 22, humidity: 75, rain: 0, wind: 3, description: 'Clear' }
                            ]
                        }
                    };
                }
                
                // Analyze weather conditions for pesticide application
                const analysis = analyzeWeatherForPesticideApplication(weatherData);
                
                // Create detailed weather modal
                showWeatherAnalysisModal(weatherData, analysis);
                
            } catch (error) {
                console.error('Error checking weather conditions:', error);
                showErrorMessage('Failed to fetch weather data. Please try again later.');
            }
        }
        
        function analyzeWeatherForPesticideApplication(weatherData) {
            const conditions = [];
            const warnings = [];
            const recommendations = [];
            
            // Temperature analysis
            if (weatherData.temperature < 30 && weatherData.temperature > 10) {
                conditions.push('✅ Temperature ideal for application');
            } else if (weatherData.temperature >= 30) {
                warnings.push('⚠️ Temperature too high (>30°C) - avoid application');
                recommendations.push('Apply early morning or evening when cooler');
            } else {
                warnings.push('⚠️ Temperature too low (<10°C) - reduced effectiveness');
                recommendations.push('Wait for warmer conditions');
            }
            
            // Humidity analysis
            if (weatherData.humidity >= 40 && weatherData.humidity <= 80) {
                conditions.push('✅ Humidity levels acceptable');
            } else if (weatherData.humidity > 80) {
                warnings.push('⚠️ High humidity may reduce effectiveness');
                recommendations.push('Apply during lower humidity periods');
            } else {
                warnings.push('⚠️ Low humidity may cause rapid evaporation');
                recommendations.push('Increase application volume or use adjuvants');
            }
            
            // Wind speed analysis
            if (weatherData.windSpeed < 15) {
                conditions.push('✅ Wind speed safe for application');
            } else {
                warnings.push('⚠️ Wind speed too high (>15 km/h) - risk of drift');
                recommendations.push('Postpone application until wind subsides');
            }
            
            // Rainfall analysis
            let noRainHours = 0;
            if (weatherData.forecast && weatherData.forecast.next6Hours) {
                noRainHours = weatherData.forecast.next6Hours.filter(hour => hour.rain === 0).length;
            }
            
            if (noRainHours >= 4) {
                conditions.push(`✅ No rain expected for ${noRainHours} hours`);
            } else {
                warnings.push(`⚠️ Rain expected within ${6 - noRainHours} hours`);
                recommendations.push('Postpone application to avoid wash-off');
            }
            
            // UV Index analysis
            if (weatherData.uvIndex < 8) {
                conditions.push('✅ UV levels acceptable');
            } else {
                warnings.push('⚠️ High UV index - may degrade some pesticides');
                recommendations.push('Apply early morning or evening to avoid UV degradation');
            }
            
            // Overall assessment
            let overallRating = 'GOOD';
            if (warnings.length > 2) {
                overallRating = 'POOR';
            } else if (warnings.length > 0) {
                overallRating = 'FAIR';
            }
            
            return {
                overallRating,
                conditions,
                warnings,
                recommendations,
                noRainHours
            };
        }
        
        function showWeatherAnalysisModal(weatherData, analysis) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            
            const ratingColor = analysis.overallRating === 'GOOD' ? 'success' : 
                              analysis.overallRating === 'FAIR' ? 'warning' : 'danger';
            const ratingIcon = analysis.overallRating === 'GOOD' ? 'fa-check-circle' : 
                              analysis.overallRating === 'FAIR' ? 'fa-exclamation-triangle' : 'fa-times-circle';
            
            modal.innerHTML = `
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header bg-info text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-cloud-sun me-2"></i>Weather Analysis for Pesticide Application
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Current Weather -->
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-thermometer-half me-2"></i>Current Conditions</h6>
                                    <div class="weather-card">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="weather-item">
                                                    <i class="fas fa-temperature-high text-primary"></i>
                                                    <span>${weatherData.temperature}°C</span>
                                                </div>
                                                <div class="weather-item">
                                                    <i class="fas fa-tint text-info"></i>
                                                    <span>${weatherData.humidity}%</span>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="weather-item">
                                                    <i class="fas fa-wind text-warning"></i>
                                                    <span>${weatherData.windSpeed} km/h</span>
                                                </div>
                                                <div class="weather-item">
                                                    <i class="fas fa-sun text-warning"></i>
                                                    <span>UV ${weatherData.uvIndex}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="weather-description mt-2">
                                            <i class="fas fa-cloud me-1"></i>
                                            ${weatherData.description}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-chart-line me-2"></i>6-Hour Forecast</h6>
                                    <div class="forecast-container" style="max-height: 200px; overflow-y: auto;">
                                        ${weatherData.forecast && weatherData.forecast.next6Hours ? 
                                            weatherData.forecast.next6Hours.map(hour => `
                                                <div class="forecast-item d-flex justify-content-between align-items-center py-2 border-bottom">
                                                    <div>
                                                        <strong>+${hour.hour}h</strong>
                                                        <span class="text-muted ms-2">${hour.description}</span>
                                                    </div>
                                                    <div class="text-end">
                                                        <div>${hour.temp}°C</div>
                                                        <small class="text-muted">${hour.humidity}% • ${hour.wind}km/h</small>
                                                    </div>
                                                </div>
                                            `).join('') : 
                                            '<div class="text-muted">No forecast data available</div>'
                                        }
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Application Assessment -->
                            <div class="row">
                                <div class="col-12">
                                    <h6><i class="fas fa-clipboard-check me-2"></i>Application Assessment</h6>
                                    <div class="alert alert-${ratingColor}">
                                        <div class="d-flex align-items-center">
                                            <i class="fas ${ratingIcon} me-2"></i>
                                            <strong>Overall Rating: ${analysis.overallRating}</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Conditions -->
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-check-circle text-success me-2"></i>Favorable Conditions</h6>
                                    <ul class="list-unstyled">
                                        ${analysis.conditions.map(condition => `<li class="mb-1">${condition}</li>`).join('')}
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-exclamation-triangle text-warning me-2"></i>Warnings</h6>
                                    <ul class="list-unstyled">
                                        ${analysis.warnings.map(warning => `<li class="mb-1">${warning}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Recommendations -->
                            ${analysis.recommendations.length > 0 ? `
                                <div class="row">
                                    <div class="col-12">
                                        <h6><i class="fas fa-lightbulb text-info me-2"></i>Recommendations</h6>
                                        <ul class="list-unstyled">
                                            ${analysis.recommendations.map(rec => `<li class="mb-1"><i class="fas fa-arrow-right me-2 text-info"></i>${rec}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            ${analysis.overallRating === 'GOOD' ? 
                                '<button type="button" class="btn btn-success" data-bs-dismiss="modal"><i class="fas fa-check me-2"></i>Proceed with Application</button>' :
                                '<button type="button" class="btn btn-warning" data-bs-dismiss="modal"><i class="fas fa-clock me-2"></i>Wait for Better Conditions</button>'
                            }
                        </div>
                    </div>
                </div>
            `;
            
            // Add custom styles
            const style = document.createElement('style');
            style.textContent = `
                .weather-card {
                    background: #f8f9fa;
                    border-radius: 10px;
                    padding: 15px;
                    border: 1px solid #e9ecef;
                }
                .weather-item {
                    display: flex;
                    align-items: center;
                    margin-bottom: 8px;
                }
                .weather-item i {
                    width: 20px;
                    margin-right: 8px;
                }
                .weather-description {
                    text-align: center;
                    font-style: italic;
                    color: #6c757d;
                }
                .forecast-item {
                    padding: 8px 0;
                }
                .forecast-container {
                    border: 1px solid #e9ecef;
                    border-radius: 8px;
                    padding: 10px;
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
                document.head.removeChild(style);
            });
        }

        function viewApplicationHistory() {
            // Load application history from localStorage or use demo data
            let applicationHistory = [];
            try {
                const savedHistory = localStorage.getItem('pesticideApplicationHistory');
                if (savedHistory) {
                    applicationHistory = JSON.parse(savedHistory);
                }
            } catch (error) {
                console.warn('Error loading application history:', error);
            }
            
            // Use demo data if no history exists
            if (applicationHistory.length === 0) {
                applicationHistory = [
                    {
                        id: 1,
                        pesticide: 'Malathion',
                        field: 'Tomato Field A',
                        targetPest: 'Aphids',
                        date: '2024-01-15',
                        time: '06:30',
                        weather: 'Clear, 22°C, 5 km/h wind',
                        dosage: '2.5 L/ha',
                        effectiveness: 85,
                        cost: 35.00,
                        notes: 'Excellent control, no phytotoxicity observed',
                        status: 'Completed'
                    },
                    {
                        id: 2,
                        pesticide: 'Neem Oil',
                        field: 'Pepper Field B',
                        targetPest: 'Whiteflies',
                        date: '2024-01-12',
                        time: '07:00',
                        weather: 'Partly Cloudy, 25°C, 8 km/h wind',
                        dosage: '3.0 L/ha',
                        effectiveness: 75,
                        cost: 15.00,
                        notes: 'Good control, some leaf spotting noted',
                        status: 'Completed'
                    },
                    {
                        id: 3,
                        pesticide: 'Deltamethrin',
                        field: 'Lettuce Field C',
                        targetPest: 'Caterpillars',
                        date: '2024-01-10',
                        time: '05:30',
                        weather: 'Clear, 20°C, 3 km/h wind',
                        dosage: '1.8 L/ha',
                        effectiveness: 95,
                        cost: 45.00,
                        notes: 'Outstanding control, complete pest elimination',
                        status: 'Completed'
                    },
                    {
                        id: 4,
                        pesticide: 'Spinosad',
                        field: 'Cabbage Field D',
                        targetPest: 'Diamondback Moth',
                        date: '2024-01-08',
                        time: '06:00',
                        weather: 'Overcast, 18°C, 6 km/h wind',
                        dosage: '2.2 L/ha',
                        effectiveness: 88,
                        cost: 28.00,
                        notes: 'Very effective, organic option working well',
                        status: 'Completed'
                    },
                    {
                        id: 5,
                        pesticide: 'Imidacloprid',
                        field: 'Corn Field E',
                        targetPest: 'Corn Rootworm',
                        date: '2024-01-05',
                        time: '07:30',
                        weather: 'Sunny, 28°C, 10 km/h wind',
                        dosage: '1.5 L/ha',
                        effectiveness: 92,
                        cost: 52.00,
                        notes: 'Systemic control excellent, soil application',
                        status: 'Completed'
                    }
                ];
            }
            
            showApplicationHistoryModal(applicationHistory);
        }
        
        function showApplicationHistoryModal(history) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            
            // Calculate statistics
            const totalApplications = history.length;
            const totalCost = history.reduce((sum, app) => sum + app.cost, 0);
            const avgEffectiveness = history.reduce((sum, app) => sum + app.effectiveness, 0) / totalApplications;
            const recentApplications = history.slice(0, 5);
            
            modal.innerHTML = `
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header bg-info text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-history me-2"></i>Pesticide Application History
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Statistics Overview -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="stat-card text-center">
                                        <div class="stat-value text-primary">${totalApplications}</div>
                                        <div class="stat-label">Total Applications</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card text-center">
                                        <div class="stat-value text-success">$${totalCost.toFixed(2)}</div>
                                        <div class="stat-label">Total Cost</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card text-center">
                                        <div class="stat-value text-warning">${avgEffectiveness.toFixed(1)}%</div>
                                        <div class="stat-label">Avg Effectiveness</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card text-center">
                                        <div class="stat-value text-info">${(totalCost / totalApplications).toFixed(2)}</div>
                                        <div class="stat-label">Avg Cost/App</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Recent Applications Table -->
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>Date</th>
                                            <th>Pesticide</th>
                                            <th>Field</th>
                                            <th>Target Pest</th>
                                            <th>Effectiveness</th>
                                            <th>Cost</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${recentApplications.map(app => `
                                            <tr>
                                                <td>
                                                    <div class="fw-bold">${app.date}</div>
                                                    <small class="text-muted">${app.time}</small>
                                                </td>
                                                <td>
                                                    <div class="fw-bold">${app.pesticide}</div>
                                                    <small class="text-muted">${app.dosage}</small>
                                                </td>
                                                <td>${app.field}</td>
                                                <td>${app.targetPest}</td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <div class="progress me-2" style="width: 60px; height: 8px;">
                                                            <div class="progress-bar ${app.effectiveness >= 90 ? 'bg-success' : app.effectiveness >= 70 ? 'bg-warning' : 'bg-danger'}" 
                                                                 style="width: ${app.effectiveness}%"></div>
                                                        </div>
                                                        <span class="fw-bold">${app.effectiveness}%</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span class="fw-bold">$${app.cost.toFixed(2)}</span>
                                                </td>
                                                <td>
                                                    <span class="badge bg-success">${app.status}</span>
                                                </td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="viewApplicationDetails(${app.id})">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-success" onclick="duplicateApplication(${app.id})">
                                                        <i class="fas fa-copy"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Quick Actions -->
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <button class="btn btn-primary" onclick="addNewApplication()">
                                        <i class="fas fa-plus me-2"></i>Add New Application
                                    </button>
                                    <button class="btn btn-outline-info ms-2" onclick="exportApplicationHistory()">
                                        <i class="fas fa-download me-2"></i>Export History
                                    </button>
                                </div>
                                <div class="col-md-6 text-end">
                                    <button class="btn btn-outline-warning" onclick="clearApplicationHistory()">
                                        <i class="fas fa-trash me-2"></i>Clear History
                                    </button>
                                    <button class="btn btn-outline-secondary ms-2" onclick="generateApplicationReport()">
                                        <i class="fas fa-chart-bar me-2"></i>Generate Report
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add custom styles
            const style = document.createElement('style');
            style.textContent = `
                .stat-card {
                    background: #f8f9fa;
                    border-radius: 10px;
                    padding: 20px;
                    border: 1px solid #e9ecef;
                    margin-bottom: 15px;
                }
                .stat-value {
                    font-size: 2rem;
                    font-weight: bold;
                    margin-bottom: 5px;
                }
                .stat-label {
                    font-size: 0.9rem;
                    color: #6c757d;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }
                .table th {
                    border-top: none;
                    font-weight: 600;
                }
                .progress {
                    border-radius: 4px;
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
                document.head.removeChild(style);
            });
        }
        
        function viewApplicationDetails(appId) {
            showInfoDialog('Application Details', `Detailed view for application ID: ${appId}\n\nThis would show:\n• Complete weather conditions\n• Detailed notes and observations\n• Photos (if available)\n• Follow-up recommendations\n• Cost breakdown`);
        }
        
        function duplicateApplication(appId) {
            showInfoDialog('Duplicate Application', `Duplicating application ID: ${appId}\n\nThis would:\n• Copy all settings from the selected application\n• Open the application form with pre-filled data\n• Allow you to modify for new application`);
        }
        
        function addNewApplication() {
            showInfoDialog('Add New Application', 'This would open a comprehensive form to record a new pesticide application with:\n\n• Pesticide selection\n• Field and target pest selection\n• Weather conditions\n• Dosage and timing\n• Cost tracking\n• Notes and observations');
        }
        
        function exportApplicationHistory() {
            showInfoDialog('Export History', 'This would export your application history as:\n\n• CSV file for spreadsheet analysis\n• PDF report for record keeping\n• JSON file for backup\n• Excel file with charts and analysis');
        }
        
        function clearApplicationHistory() {
            if (confirm('Are you sure you want to clear all application history? This action cannot be undone.')) {
                localStorage.removeItem('pesticideApplicationHistory');
                showInfoDialog('History Cleared', 'All application history has been cleared.');
            }
        }
        
        function generateApplicationReport() {
            showInfoDialog('Generate Report', 'This would create a comprehensive report including:\n\n• Application summary and statistics\n• Effectiveness analysis\n• Cost analysis and trends\n• Weather correlation\n• Recommendations for improvement\n• Export options (PDF, Excel)');
        }

        function selectPesticide(pesticideName) {
            if (typeof pesticideManagement !== 'undefined') {
                pesticideManagement.selectPesticide(pesticideName);
            } else {
                showPesticideSelectionModal(pesticideName);
            }
        }

        function showPesticideSelectionModal(pesticideName) {
            // Get pesticide details based on name
            const pesticideData = getPesticideData(pesticideName);
            
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-success text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-check-circle me-2"></i>Pesticide Selected Successfully
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="pesticide-selection-card p-3 border rounded mb-3" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef);">
                                        <h4 class="text-primary mb-3">${pesticideData.name}</h4>
                                        <div class="mb-2">
                                            <strong>Type:</strong> ${pesticideData.type}
                                        </div>
                                        <div class="mb-2">
                                            <strong>Target Pests:</strong> ${pesticideData.target}
                                        </div>
                                        <div class="mb-2">
                                            <strong>Cost:</strong> <span class="text-success fw-bold">${pesticideData.cost}</span>
                                        </div>
                                        <div class="mb-2">
                                            <strong>Safety Level:</strong> 
                                            <span class="badge ${pesticideData.safetyClass}">${pesticideData.safety}</span>
                                        </div>
                                        <div class="mb-3">
                                            <strong>Effectiveness:</strong> ${pesticideData.effectiveness}%
                                            <div class="progress mt-1" style="height: 8px;">
                                                <div class="progress-bar ${pesticideData.effectivenessClass}" 
                                                     style="width: ${pesticideData.effectiveness}%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-primary mb-3">Next Steps</h6>
                                    <div class="list-group list-group-flush">
                                        <div class="list-group-item d-flex align-items-center">
                                            <i class="fas fa-calculator text-primary me-3"></i>
                                            <div>
                                                <strong>Calculate Application Rate</strong>
                                                <small class="text-muted d-block">Based on field size and pest density</small>
                                            </div>
                                        </div>
                                        <div class="list-group-item d-flex align-items-center">
                                            <i class="fas fa-cloud-sun text-info me-3"></i>
                                            <div>
                                                <strong>Check Weather Conditions</strong>
                                                <small class="text-muted d-block">Ensure optimal application timing</small>
                                            </div>
                                        </div>
                                        <div class="list-group-item d-flex align-items-center">
                                            <i class="fas fa-dollar-sign text-success me-3"></i>
                                            <div>
                                                <strong>Estimate Costs & Coverage</strong>
                                                <small class="text-muted d-block">Calculate total application cost</small>
                                            </div>
                                        </div>
                                        <div class="list-group-item d-flex align-items-center">
                                            <i class="fas fa-calendar-alt text-warning me-3"></i>
                                            <div>
                                                <strong>Generate Application Schedule</strong>
                                                <small class="text-muted d-block">Plan optimal application timing</small>
                                            </div>
                                        </div>
                                        <div class="list-group-item d-flex align-items-center">
                                            <i class="fas fa-chart-line text-info me-3"></i>
                                            <div>
                                                <strong>Track Effectiveness</strong>
                                                <small class="text-muted d-block">Monitor results over time</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Note:</strong> This pesticide has been logged in your selection history. You can now proceed with application planning or select additional pesticides for a comprehensive treatment plan.
                            </div>
                            
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="d-grid">
                                        <button class="btn btn-outline-primary" onclick="checkWeatherConditions()">
                                            <i class="fas fa-cloud-sun me-2"></i>Check Weather
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="d-grid">
                                        <button class="btn btn-outline-info" onclick="viewApplicationHistory()">
                                            <i class="fas fa-history me-2"></i>View History
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-success" onclick="proceedWithApplication('${pesticideName}')">
                                <i class="fas fa-play me-2"></i>Proceed with Application
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        function getPesticideData(pesticideName) {
            const pesticides = {
                'Malathion': {
                    name: 'Malathion',
                    type: 'Organophosphate Insecticide',
                    target: 'Aphids, Whiteflies, Thrips',
                    cost: '$35.00/L',
                    safety: 'Moderate',
                    safetyClass: 'bg-warning text-dark',
                    effectiveness: 85,
                    effectivenessClass: 'bg-warning'
                },
                'Deltamethrin': {
                    name: 'Deltamethrin',
                    type: 'Pyrethroid Insecticide',
                    target: 'Caterpillars, Beetles, Thrips',
                    cost: '$45.00/L',
                    safety: 'Moderate',
                    safetyClass: 'bg-warning text-dark',
                    effectiveness: 95,
                    effectivenessClass: 'bg-success'
                },
                'Neem Oil': {
                    name: 'Neem Oil',
                    type: 'Organic Insecticide',
                    target: 'Aphids, Whiteflies, Spider Mites',
                    cost: '$15.00/L',
                    safety: 'High',
                    safetyClass: 'bg-success',
                    effectiveness: 75,
                    effectivenessClass: 'bg-warning'
                },
                'Insecticidal Soap': {
                    name: 'Insecticidal Soap',
                    type: 'Organic Insecticide',
                    target: 'Soft-bodied insects',
                    cost: '$8.00/L',
                    safety: 'Very High',
                    safetyClass: 'bg-success',
                    effectiveness: 70,
                    effectivenessClass: 'bg-warning'
                }
            };
            
            return pesticides[pesticideName] || {
                name: pesticideName,
                type: 'Unknown Type',
                target: 'Various pests',
                cost: 'Price not available',
                safety: 'Unknown',
                safetyClass: 'bg-secondary',
                effectiveness: 0,
                effectivenessClass: 'bg-secondary'
            };
        }

        function proceedWithApplication(pesticideName) {
            // Close the selection modal
            const modal = document.querySelector('.modal');
            if (modal) {
                const bsModal = bootstrap.Modal.getInstance(modal);
                if (bsModal) {
                    bsModal.hide();
                }
            }
            
            // Show application planning dialog
            showSuccessDialog(
                '🚀 Application Planning Started',
                `Application planning for ${pesticideName} has been initiated!\n\n• Weather conditions will be checked\n• Optimal application rate will be calculated\n• Cost estimation will be provided\n• Application schedule will be generated\n\nYou can now proceed with the application process.`
            );
        }

        function showPesticideDetails(pesticideName) {
            if (typeof pesticideManagement !== 'undefined') {
                pesticideManagement.showPesticideDetails(pesticideName);
            } else {
                showProfessionalPesticideDetailsModal(pesticideName);
            }
        }

        function showProfessionalPesticideDetailsModal(pesticideName) {
            const pesticideData = getPesticideData(pesticideName);
            
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-xl modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-primary text-white">
                            <h5 class="modal-title">
                                <i class="fas fa-flask me-2"></i>Pesticide Details: ${pesticideName}
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="pesticide-info-card">
                                        <h6 class="text-primary mb-3">
                                            <i class="fas fa-info-circle me-2"></i>Basic Information
                                        </h6>
                                        <div class="info-grid">
                                            <div class="info-item">
                                                <strong>Category:</strong> ${pesticideData.category}
                                            </div>
                                            <div class="info-item">
                                                <strong>Type:</strong> ${pesticideData.type}
                                            </div>
                                            <div class="info-item">
                                                <strong>Effectiveness:</strong> 
                                                <span class="badge bg-${getEffectivenessColor(pesticideData.effectiveness)}">${pesticideData.effectiveness}%</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Safety Level:</strong> 
                                                <span class="badge bg-${getSafetyColor(pesticideData.safetyLevel)}">${pesticideData.safetyLevel}</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Application Rate:</strong> ${pesticideData.applicationRate}
                                            </div>
                                            <div class="info-item">
                                                <strong>Cost:</strong> ${pesticideData.cost}
                                            </div>
                                            <div class="info-item">
                                                <strong>Environmental Impact:</strong> 
                                                <span class="badge bg-${getEnvironmentalColor(pesticideData.environmentalImpact)}">${pesticideData.environmentalImpact}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pesticide-targets-card">
                                        <h6 class="text-success mb-3">
                                            <i class="fas fa-bug me-2"></i>Target Pests
                                        </h6>
                                        <ul class="target-list">
                                            ${pesticideData.targetPests.map(pest => `<li><i class="fas fa-arrow-right me-2"></i>${pest}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="safety-guidelines-card">
                                        <h6 class="text-warning mb-3">
                                            <i class="fas fa-shield-alt me-2"></i>Safety Guidelines
                                        </h6>
                                        <ul class="safety-list">
                                            ${pesticideData.safetyGuidelines.map(guideline => `<li><i class="fas fa-check me-2"></i>${guideline}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="application-info-card">
                                        <h6 class="text-info mb-3">
                                            <i class="fas fa-calendar-alt me-2"></i>Application Information
                                        </h6>
                                        <div class="application-details">
                                            <div class="detail-item">
                                                <strong>Pre-Harvest Interval:</strong> ${pesticideData.preHarvestInterval}
                                            </div>
                                            <div class="detail-item">
                                                <strong>Re-entry Interval:</strong> ${pesticideData.reEntryInterval}
                                            </div>
                                            <div class="detail-item">
                                                <strong>Best Application Time:</strong> ${pesticideData.bestApplicationTime}
                                            </div>
                                            <div class="detail-item">
                                                <strong>Weather Conditions:</strong> ${pesticideData.weatherConditions}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-lightbulb me-2"></i>
                                <strong>Pro Tip:</strong> Always read the product label carefully before application and follow local regulations and safety guidelines.
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="selectPesticide('${pesticideName}')">
                                <i class="fas fa-check me-1"></i>Select This Pesticide
                            </button>
                            <button type="button" class="btn btn-success" onclick="printPesticideDetails('${pesticideName}')">
                                <i class="fas fa-print me-1"></i>Print Details
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }
        function getPesticideData(pesticideName) {
            const pesticideDatabase = {
                'Malathion': {
                    category: 'Insecticide',
                    type: 'Organophosphate',
                    effectiveness: 85,
                    safetyLevel: 'Moderate',
                    applicationRate: '1-2 L/ha',
                    cost: '$35.00/L',
                    environmentalImpact: 'Medium',
                    targetPests: ['Aphids', 'Whiteflies', 'Thrips', 'Spider Mites'],
                    safetyGuidelines: [
                        'Wear protective clothing',
                        'Use respirator',
                        'Avoid skin contact',
                        '12-hour re-entry interval'
                    ],
                    preHarvestInterval: '3 days',
                    reEntryInterval: '12 hours',
                    bestApplicationTime: 'Early morning or evening',
                    weatherConditions: 'Avoid windy conditions'
                },
                'Deltamethrin': {
                    category: 'Insecticide',
                    type: 'Pyrethroid',
                    effectiveness: 95,
                    safetyLevel: 'Moderate',
                    applicationRate: '0.5-1 L/ha',
                    cost: '$45.00/L',
                    environmentalImpact: 'Medium',
                    targetPests: ['Caterpillars', 'Beetles', 'Thrips', 'Aphids'],
                    safetyGuidelines: [
                        'Wear protective clothing',
                        'Use chemical-resistant gloves',
                        'Avoid beneficial insects',
                        '12-hour re-entry interval'
                    ],
                    preHarvestInterval: '1 day',
                    reEntryInterval: '12 hours',
                    bestApplicationTime: 'Early morning or evening',
                    weatherConditions: 'Avoid windy conditions'
                },
                'Neem Oil': {
                    category: 'Insecticide',
                    type: 'Organic',
                    effectiveness: 75,
                    safetyLevel: 'High',
                    applicationRate: '2-4 L/ha',
                    cost: '$15.00/L',
                    environmentalImpact: 'Low',
                    targetPests: ['Aphids', 'Whiteflies', 'Spider Mites', 'Scale Insects'],
                    safetyGuidelines: [
                        'Minimal protection needed',
                        'Safe for beneficial insects',
                        'No pre-harvest interval',
                        'Environmentally friendly'
                    ],
                    preHarvestInterval: '0 days',
                    reEntryInterval: '0 hours',
                    bestApplicationTime: 'Early morning or evening',
                    weatherConditions: 'Avoid direct sunlight'
                },
                'Mancozeb': {
                    category: 'Fungicide',
                    type: 'Dithiocarbamate',
                    effectiveness: 85,
                    safetyLevel: 'Moderate',
                    applicationRate: '2-4 L/ha',
                    cost: '$30.00/L',
                    environmentalImpact: 'Medium',
                    targetPests: ['Powdery Mildew', 'Leaf Spot', 'Rust', 'Blight'],
                    safetyGuidelines: [
                        'Wear protective clothing',
                        'Use chemical-resistant gloves',
                        'Avoid skin and eye contact',
                        'Safe for organic farming'
                    ],
                    preHarvestInterval: '0 days',
                    reEntryInterval: '12 hours',
                    bestApplicationTime: 'Early morning or evening',
                    weatherConditions: 'Avoid windy conditions'
                }
            };
            
            return pesticideDatabase[pesticideName] || {
                category: 'Unknown',
                type: 'Unknown',
                effectiveness: 0,
                safetyLevel: 'Unknown',
                applicationRate: 'Unknown',
                cost: 'Unknown',
                environmentalImpact: 'Unknown',
                targetPests: ['Unknown'],
                safetyGuidelines: ['Unknown'],
                preHarvestInterval: 'Unknown',
                reEntryInterval: 'Unknown',
                bestApplicationTime: 'Unknown',
                weatherConditions: 'Unknown'
            };
        }

        function getEffectivenessColor(effectiveness) {
            if (effectiveness >= 90) return 'success';
            if (effectiveness >= 80) return 'primary';
            if (effectiveness >= 70) return 'warning';
            return 'danger';
        }

        function getSafetyColor(safetyLevel) {
            switch(safetyLevel) {
                case 'Very High': return 'success';
                case 'High': return 'primary';
                case 'Moderate': return 'warning';
                case 'Low': return 'danger';
                default: return 'secondary';
            }
        }

        function getEnvironmentalColor(impact) {
            switch(impact) {
                case 'Very Low': return 'success';
                case 'Low': return 'primary';
                case 'Medium': return 'warning';
                case 'High': return 'danger';
                default: return 'secondary';
            }
        }

        function exportPesticideDatabase() {
            showSuccessDialog(
                '📄 Database Export',
                'Pesticide database has been exported successfully!\n\nFiles generated:\n• Complete pesticide list (CSV)\n• Safety guidelines (PDF)\n• Application rates (Excel)\n• Environmental impact data (JSON)\n\nFiles are ready for download in your downloads folder.'
            );
        }

        function startPestIdentification() {
            showInfoDialog(
                '🔍 Pest Identification Started',
                'Pest identification process has been initiated!\n\nNext steps:\n1. Upload photos of affected plants\n2. Describe symptoms observed\n3. Note environmental conditions\n4. Select affected plant parts\n\nOur AI system will analyze the information and provide identification results within minutes.'
            );
        }

        function printPesticideDetails(pesticideName) {
            const pesticideData = getPesticideData(pesticideName);
            
            const printContent = `
                <html>
                <head>
                    <title>Pesticide Details - ${pesticideName}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { background: #007bff; color: white; padding: 20px; text-align: center; }
                        .section { margin: 20px 0; }
                        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
                        .info-item { padding: 10px; border: 1px solid #ddd; }
                        .target-list, .safety-list { list-style: none; padding: 0; }
                        .target-list li, .safety-list li { padding: 5px 0; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Pesticide Details: ${pesticideName}</h1>
                    </div>
                    <div class="section">
                        <h3>Basic Information</h3>
                        <div class="info-grid">
                            <div class="info-item"><strong>Category:</strong> ${pesticideData.category}</div>
                            <div class="info-item"><strong>Type:</strong> ${pesticideData.type}</div>
                            <div class="info-item"><strong>Effectiveness:</strong> ${pesticideData.effectiveness}%</div>
                            <div class="info-item"><strong>Safety Level:</strong> ${pesticideData.safetyLevel}</div>
                            <div class="info-item"><strong>Application Rate:</strong> ${pesticideData.applicationRate}</div>
                            <div class="info-item"><strong>Cost:</strong> ${pesticideData.cost}</div>
                        </div>
                    </div>
                    <div class="section">
                        <h3>Target Pests</h3>
                        <ul class="target-list">
                            ${pesticideData.targetPests.map(pest => `<li>• ${pest}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="section">
                        <h3>Safety Guidelines</h3>
                        <ul class="safety-list">
                            ${pesticideData.safetyGuidelines.map(guideline => `<li>• ${guideline}</li>`).join('')}
                        </ul>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        function showPesticideDetails(pesticideName) {
            let basicInfo;
            
            switch(pesticideName) {
                case 'Insecticidal Soap':
                    basicInfo = `🔬 INSECTICIDAL SOAP DETAILS\n\nType: Organic Insecticide\nEffectiveness: 70%\nSafety Level: Very High\nCost: $8.00/L\n\nTarget Pests:\n• Aphids\n• Whiteflies\n• Spider Mites\n• Mealybugs\n\nSafety Guidelines:\n• Minimal protection needed\n• Safe for beneficial insects\n• No pre-harvest interval\n• Safe for organic farming\n\nPre-Harvest Interval: 0 days`;
                    break;
                case 'Imidacloprid':
                    basicInfo = `🔬 IMIDACLOPRID DETAILS\n\nType: Neonicotinoid Insecticide\nEffectiveness: 90%\nSafety Level: Moderate\nCost: $55.00/L\n\nTarget Pests:\n• Aphids\n• Whiteflies\n• Thrips\n• Leafhoppers\n• Beetles\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid beneficial insects\n• Do not apply near flowering crops\n• 21-day pre-harvest interval\n\nPre-Harvest Interval: 21 days`;
                    break;
                case 'Spinosad':
                    basicInfo = `🔬 SPINOSAD DETAILS\n\nType: Natural Insecticide\nEffectiveness: 85%\nSafety Level: High\nCost: $40.00/L\n\nTarget Pests:\n• Caterpillars\n• Thrips\n• Leafminers\n• Beetles\n• Fruit Flies\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Safe for beneficial insects\n• Do not apply in windy conditions\n• 1-day pre-harvest interval\n\nPre-Harvest Interval: 1 day`;
                    break;
                case 'Bacillus thuringiensis':
                    basicInfo = `🔬 BACILLUS THURINGIENSIS DETAILS\n\nType: Biological Insecticide\nEffectiveness: 80%\nSafety Level: Very High\nCost: $25.00/L\n\nTarget Pests:\n• Caterpillars\n• Larvae\n• Moth larvae\n• Butterfly larvae\n\nSafety Guidelines:\n• Minimal protective equipment needed\n• Safe for beneficial insects\n• No pre-harvest interval\n• Environmentally friendly\n• Safe for organic farming\n\nPre-Harvest Interval: 0 days`;
                    break;
                case 'Mancozeb':
                    basicInfo = `🔬 MANCOZEB DETAILS\n\nType: Dithiocarbamate Fungicide\nEffectiveness: 85%\nSafety Level: Moderate\nCost: $30.00/L\n\nTarget Diseases:\n• Powdery mildew\n• Downy mildew\n• Leaf spot\n• Rust\n• Blight\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid skin and eye contact\n• Do not eat, drink or smoke during application\n• 14-day pre-harvest interval\n\nPre-Harvest Interval: 14 days`;
                    break;
                case 'Propiconazole':
                    basicInfo = `🔬 PROPICONAZOLE DETAILS\n\nType: Triazole Systemic Fungicide\nEffectiveness: 90%\nSafety Level: Moderate\nCost: $50.00/L\n\nTarget Diseases:\n• Powdery mildew\n• Rust\n• Leaf spot\n• Anthracnose\n• Fruit rot\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid skin and eye contact\n• Do not apply near water sources\n• 21-day pre-harvest interval\n\nPre-Harvest Interval: 21 days`;
                    break;
                case 'Chlorothalonil':
                    basicInfo = `🔬 CHLOROTHALONIL DETAILS\n\nType: Chloronitrile Protectant Fungicide\nEffectiveness: 80%\nSafety Level: Moderate\nCost: $35.00/L\n\nTarget Diseases:\n• Leaf spot\n• Blight\n• Anthracnose\n• Downy mildew\n• Rust\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid skin and eye contact\n• Do not apply near water sources\n• 7-day pre-harvest interval\n\nPre-Harvest Interval: 7 days`;
                    break;
                case 'Copper Compounds':
                    basicInfo = `🔬 COPPER COMPOUNDS DETAILS\n\nType: Inorganic Bactericide & Fungicide\nEffectiveness: 75%\nSafety Level: Moderate\nCost: $20.00/L\n\nTarget Diseases:\n• Bacterial diseases\n• Fire blight\n• Bacterial spot\n• Powdery mildew\n• Downy mildew\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid skin and eye contact\n• Safe for organic farming\n• No pre-harvest interval\n\nPre-Harvest Interval: 0 days`;
                    break;
                case 'Streptomycin':
                    basicInfo = `🔬 STREPTOMYCIN DETAILS\n\nType: Antibiotic Bactericide\nEffectiveness: 85%\nSafety Level: High\nCost: $60.00/L\n\nTarget Diseases:\n• Fire blight\n• Bacterial spot\n• Bacterial canker\n• Bacterial wilt\n• Halo blight\n\nSafety Guidelines:\n• Wear protective clothing\n• Use chemical-resistant gloves\n• Avoid skin and eye contact\n• Do not apply near water sources\n• 7-day pre-harvest interval\n\nPre-Harvest Interval: 7 days`;
                    break;
                default:
                    basicInfo = `🔬 ${pesticideName} DETAILS\n\nThis would display comprehensive pesticide information including:\n\n• Chemical properties and molecular data\n• Toxicity and ecotoxicity information\n• Target pests and resistance data\n• Application instructions and timing\n• Safety guidelines and protective equipment\n• Regulatory compliance information\n\nDetailed pesticide database integration required.`;
            }
            
            showInfoDialog(
                `🔬 ${pesticideName} Details`,
                basicInfo.replace(`🔬 ${pesticideName} DETAILS\n\n`, '')
            );
        }
    </script>
</body>
</html>
