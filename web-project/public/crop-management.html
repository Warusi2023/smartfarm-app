<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Management - SmartFarm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2e7d32;
            --secondary-color: #4caf50;
            --accent-color: #8bc34a;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --info-color: #2196f3;
            --dark-color: #424242;
            --light-color: #f5f5f5;
        }

        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .page-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 0;
            margin-bottom: 30px;
        }

        .card-custom {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .btn-custom {
            background: var(--accent-color);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .table-custom {
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        .table-custom th {
            background: var(--light-color);
            border: none;
            font-weight: 600;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-planted { background: #d4edda; color: #155724; }
        .status-growing { background: #cce5ff; color: #004085; }
        .status-flowering { background: #fff3cd; color: #856404; }
        .status-fruiting { background: #f8d7da; color: #721c24; }
        .status-harvesting { background: #e2e3e5; color: #383d41; }
        .status-completed { background: #d1ecf1; color: #0c5460; }

        .crop-card {
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .crop-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.15);
        }

        .crop-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
        }

        .progress-custom {
            height: 8px;
            border-radius: 4px;
            background-color: #e9ecef;
        }

        .progress-bar-custom {
            background: linear-gradient(90deg, var(--accent-color), var(--secondary-color));
            border-radius: 4px;
        }

        .modal-custom .modal-content {
            border-radius: 15px;
            border: none;
        }

        .form-control-custom {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }

        .form-control-custom:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(46, 125, 50, 0.25);
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Page Header -->
    <div class="page-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <a href="dashboard.html" class="back-btn me-3">
                        <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                    </a>
                    <h1 class="mb-0">Crop Management</h1>
                    <p class="mb-0 mt-2">Manage your crops, track growth, and optimize yields</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light btn-lg" data-bs-toggle="modal" data-bs-target="#addCropModal">
                        <i class="fas fa-plus me-2"></i>Add New Crop
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="card-custom text-center">
                    <h3 class="text-primary mb-2" id="totalCrops">0</h3>
                    <p class="mb-0">Total Crops</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-custom text-center">
                    <h3 class="text-success mb-2" id="activeCrops">0</h3>
                    <p class="mb-0">Active Crops</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-custom text-center">
                    <h3 class="text-warning mb-2" id="readyHarvest">0</h3>
                    <p class="mb-0">Ready for Harvest</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-custom text-center">
                    <h3 class="text-info mb-2" id="totalYield">0</h3>
                    <p class="mb-0">Total Yield (kg)</p>
                </div>
            </div>
        </div>

        <!-- Filter and Search -->
        <div class="card-custom">
            <div class="row align-items-center">
                <div class="col-md-4">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control" id="searchInput" placeholder="Search crops...">
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="statusFilter">
                        <option value="">All Status</option>
                        <option value="planted">Planted</option>
                        <option value="growing">Growing</option>
                        <option value="flowering">Flowering</option>
                        <option value="fruiting">Fruiting</option>
                        <option value="harvesting">Harvesting</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="fieldFilter">
                        <option value="">All Fields</option>
                        <option value="Field A">Field A</option>
                        <option value="Field B">Field B</option>
                        <option value="Field C">Field C</option>
                        <option value="Greenhouse 1">Greenhouse 1</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-custom w-100" onclick="applyFilters()">
                        <i class="fas fa-filter me-2"></i>Filter
                    </button>
                </div>
            </div>
        </div>

        <!-- Crops Grid -->
        <div class="row" id="cropsContainer">
            <!-- Crop cards will be dynamically loaded here -->
        </div>

        <!-- No crops message -->
        <div id="noCropsMessage" class="text-center py-5" style="display: none;">
            <i class="fas fa-seedling fa-3x text-muted mb-3"></i>
            <h4 class="text-muted">No crops found</h4>
            <p class="text-muted">Start by adding your first crop to begin tracking and managing your farm.</p>
            <button class="btn btn-custom" data-bs-toggle="modal" data-bs-target="#addCropModal">
                <i class="fas fa-plus me-2"></i>Add Your First Crop
            </button>
        </div>
    </div>

    <!-- Add Crop Modal -->
    <div class="modal fade modal-custom" id="addCropModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Crop</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addCropForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Crop Name</label>
                                    <input type="text" class="form-control form-control-custom" id="cropName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Variety</label>
                                    <input type="text" class="form-control form-control-custom" id="cropVariety" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Field/Location</label>
                                    <select class="form-select form-control-custom" id="cropField" required>
                                        <option value="">Select Field</option>
                                        <option value="Field A">Field A</option>
                                        <option value="Field B">Field B</option>
                                        <option value="Field C">Field C</option>
                                        <option value="Greenhouse 1">Greenhouse 1</option>
                                        <option value="Greenhouse 2">Greenhouse 2</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Planting Date</label>
                                    <input type="date" class="form-control form-control-custom" id="plantingDate" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Expected Harvest Date</label>
                                    <input type="date" class="form-control form-control-custom" id="harvestDate">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Area (hectares)</label>
                                    <input type="number" class="form-control form-control-custom" id="cropArea" step="0.1" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Seed Supplier</label>
                                    <input type="text" class="form-control form-control-custom" id="seedSupplier">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Initial Investment (FJD)</label>
                                    <input type="number" class="form-control form-control-custom" id="initialInvestment" step="0.01">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control form-control-custom" id="cropNotes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom" onclick="saveNewCrop()">
                        <i class="fas fa-save me-2"></i>Save Crop
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Crop Modal -->
    <div class="modal fade modal-custom" id="editCropModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Crop</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editCropForm">
                        <input type="hidden" id="editCropId">
                        <!-- Same form fields as add crop modal -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Crop Name</label>
                                    <input type="text" class="form-control form-control-custom" id="editCropName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Variety</label>
                                    <input type="text" class="form-control form-control-custom" id="editCropVariety" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Field/Location</label>
                                    <select class="form-select form-control-custom" id="editCropField" required>
                                        <option value="">Select Field</option>
                                        <option value="Field A">Field A</option>
                                        <option value="Field B">Field B</option>
                                        <option value="Field C">Field C</option>
                                        <option value="Greenhouse 1">Greenhouse 1</option>
                                        <option value="Greenhouse 2">Greenhouse 2</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Current Status</label>
                                    <select class="form-select form-control-custom" id="editCropStatus" required>
                                        <option value="planted">Planted</option>
                                        <option value="growing">Growing</option>
                                        <option value="flowering">Flowering</option>
                                        <option value="fruiting">Fruiting</option>
                                        <option value="harvesting">Harvesting</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Planting Date</label>
                                    <input type="date" class="form-control form-control-custom" id="editPlantingDate" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Expected Harvest Date</label>
                                    <input type="date" class="form-control form-control-custom" id="editHarvestDate">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Area (hectares)</label>
                                    <input type="number" class="form-control form-control-custom" id="editCropArea" step="0.1" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Current Yield (kg)</label>
                                    <input type="number" class="form-control form-control-custom" id="editCropYield" step="0.1">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control form-control-custom" id="editCropNotes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom" onclick="updateCrop()">
                        <i class="fas fa-save me-2"></i>Update Crop
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Sample crops data
        let crops = [
            {
                id: 1,
                name: "Tomatoes",
                variety: "Cherry",
                field: "Field A",
                status: "growing",
                plantingDate: "2025-01-10",
                harvestDate: "2025-03-15",
                area: 0.5,
                yield: 0,
                notes: "Planted in greenhouse for better control"
            },
            {
                id: 2,
                name: "Capsicum",
                variety: "California Wonder",
                field: "Field B",
                status: "flowering",
                plantingDate: "2025-01-05",
                harvestDate: "2025-03-10",
                area: 0.8,
                yield: 0,
                notes: "Organic farming methods"
            },
            {
                id: 3,
                name: "Lettuce",
                variety: "Romaine",
                field: "Greenhouse 1",
                status: "harvesting",
                plantingDate: "2024-12-20",
                harvestDate: "2025-01-20",
                area: 0.3,
                yield: 45.5,
                notes: "Hydroponic system"
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication first
            checkAuthentication();
            loadCrops();
            updateStatistics();
        });

        function checkAuthentication() {
            const user = localStorage.getItem('smartfarm_user') || sessionStorage.getItem('smartfarm_user');
            const token = localStorage.getItem('smartfarm_token') || sessionStorage.getItem('smartfarm_token');
            
            if (!user) {
                console.log('No user found, redirecting to login');
                window.location.href = 'login.html';
                return;
            }
            
            // Check if session is still valid (for non-remember me users)
            const rememberMe = localStorage.getItem('smartfarm_remember');
            if (!rememberMe) {
                const loginTime = sessionStorage.getItem('smartfarm_loginTime');
                if (loginTime) {
                    const sessionAge = Date.now() - new Date(loginTime).getTime();
                    const maxSessionAge = 24 * 60 * 60 * 1000; // 24 hours
                    if (sessionAge > maxSessionAge) {
                        console.log('Session expired, redirecting to login');
                        sessionStorage.clear();
                        window.location.href = 'login.html';
                        return;
                    }
                }
            }
            
            console.log('User authenticated for crop management:', user);
        }

        function loadCrops() {
            const container = document.getElementById('cropsContainer');
            const noCropsMessage = document.getElementById('noCropsMessage');
            
            if (crops.length === 0) {
                container.innerHTML = '';
                noCropsMessage.style.display = 'block';
                return;
            }
            
            noCropsMessage.style.display = 'none';
            container.innerHTML = '';
            
            crops.forEach(crop => {
                const cropCard = createCropCard(crop);
                container.appendChild(cropCard);
            });
        }

        function createCropCard(crop) {
            const col = document.createElement('div');
            col.className = 'col-lg-4 col-md-6 mb-4';
            
            const progress = calculateProgress(crop);
            const statusClass = getStatusClass(crop.status);
            const statusText = getStatusText(crop.status);
            
            col.innerHTML = `
                <div class="crop-card">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div>
                            <h5 class="mb-1">${crop.name}</h5>
                            <p class="text-muted mb-0">${crop.variety}</p>
                        </div>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-6">
                            <small class="text-muted">Field:</small>
                            <div class="fw-bold">${crop.field}</div>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Area:</small>
                            <div class="fw-bold">${crop.area} ha</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <small class="text-muted">Growth Progress</small>
                            <small class="fw-bold">${progress}%</small>
                        </div>
                        <div class="progress progress-custom">
                            <div class="progress-bar progress-bar-custom" style="width: ${progress}%"></div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-6">
                            <small class="text-muted">Planted:</small>
                            <div class="fw-bold">${formatDate(crop.plantingDate)}</div>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Yield:</small>
                            <div class="fw-bold">${crop.yield} kg</div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button class="btn btn-sm btn-outline-primary flex-fill" onclick="editCrop(${crop.id})">
                            <i class="fas fa-edit me-1"></i>Edit
                        </button>
                        <button class="btn btn-sm btn-outline-success flex-fill" onclick="addYield(${crop.id})">
                            <i class="fas fa-plus me-1"></i>Add Yield
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCrop(${crop.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            
            return col;
        }

        function calculateProgress(crop) {
            const planted = new Date(crop.plantingDate);
            const harvest = new Date(crop.harvestDate);
            const now = new Date();
            
            const totalDays = (harvest - planted) / (1000 * 60 * 60 * 24);
            const daysPassed = (now - planted) / (1000 * 60 * 60 * 24);
            
            const progress = Math.min(Math.max((daysPassed / totalDays) * 100, 0), 100);
            return Math.round(progress);
        }

        function getStatusClass(status) {
            const classes = {
                'planted': 'status-planted',
                'growing': 'status-growing',
                'flowering': 'status-flowering',
                'fruiting': 'status-fruiting',
                'harvesting': 'status-harvesting',
                'completed': 'status-completed'
            };
            return classes[status] || 'status-planted';
        }

        function getStatusText(status) {
            return status.charAt(0).toUpperCase() + status.slice(1);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString();
        }

        function updateStatistics() {
            document.getElementById('totalCrops').textContent = crops.length;
            document.getElementById('activeCrops').textContent = crops.filter(c => c.status !== 'completed').length;
            document.getElementById('readyHarvest').textContent = crops.filter(c => c.status === 'harvesting').length;
            document.getElementById('totalYield').textContent = crops.reduce((sum, c) => sum + c.yield, 0).toFixed(1);
        }

        function saveNewCrop() {
            const cropData = {
                id: Date.now(),
                name: document.getElementById('cropName').value,
                variety: document.getElementById('cropVariety').value,
                field: document.getElementById('cropField').value,
                status: 'planted',
                plantingDate: document.getElementById('plantingDate').value,
                harvestDate: document.getElementById('harvestDate').value,
                area: parseFloat(document.getElementById('cropArea').value),
                yield: 0,
                notes: document.getElementById('cropNotes').value
            };
            
            crops.push(cropData);
            loadCrops();
            updateStatistics();
            
            // Close modal and reset form
            bootstrap.Modal.getInstance(document.getElementById('addCropModal')).hide();
            document.getElementById('addCropForm').reset();
            
            // Show success message
            showAlert('Crop added successfully!', 'success');
        }

        function editCrop(id) {
            const crop = crops.find(c => c.id === id);
            if (!crop) return;
            
            // Populate edit form
            document.getElementById('editCropId').value = crop.id;
            document.getElementById('editCropName').value = crop.name;
            document.getElementById('editCropVariety').value = crop.variety;
            document.getElementById('editCropField').value = crop.field;
            document.getElementById('editCropStatus').value = crop.status;
            document.getElementById('editPlantingDate').value = crop.plantingDate;
            document.getElementById('editHarvestDate').value = crop.harvestDate;
            document.getElementById('editCropArea').value = crop.area;
            document.getElementById('editCropYield').value = crop.yield;
            document.getElementById('editCropNotes').value = crop.notes;
            
            // Show modal
            new bootstrap.Modal(document.getElementById('editCropModal')).show();
        }

        function updateCrop() {
            const id = parseInt(document.getElementById('editCropId').value);
            const cropIndex = crops.findIndex(c => c.id === id);
            
            if (cropIndex === -1) return;
            
            crops[cropIndex] = {
                ...crops[cropIndex],
                name: document.getElementById('editCropName').value,
                variety: document.getElementById('editCropVariety').value,
                field: document.getElementById('editCropField').value,
                status: document.getElementById('editCropStatus').value,
                plantingDate: document.getElementById('editPlantingDate').value,
                harvestDate: document.getElementById('editHarvestDate').value,
                area: parseFloat(document.getElementById('editCropArea').value),
                yield: parseFloat(document.getElementById('editCropYield').value) || 0,
                notes: document.getElementById('editCropNotes').value
            };
            
            loadCrops();
            updateStatistics();
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('editCropModal')).hide();
            
            // Show success message
            showAlert('Crop updated successfully!', 'success');
        }

        function deleteCrop(id) {
            if (confirm('Are you sure you want to delete this crop? This action cannot be undone.')) {
                crops = crops.filter(c => c.id !== id);
                loadCrops();
                updateStatistics();
                showAlert('Crop deleted successfully!', 'success');
            }
        }

        function addYield(id) {
            const yieldAmount = prompt('Enter yield amount (kg):');
            if (yieldAmount && !isNaN(yieldAmount)) {
                const cropIndex = crops.findIndex(c => c.id === id);
                if (cropIndex !== -1) {
                    crops[cropIndex].yield += parseFloat(yieldAmount);
                    loadCrops();
                    updateStatistics();
                    showAlert(`Added ${yieldAmount} kg to yield!`, 'success');
                }
            }
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const fieldFilter = document.getElementById('fieldFilter').value;
            
            let filteredCrops = crops;
            
            if (searchTerm) {
                filteredCrops = filteredCrops.filter(crop => 
                    crop.name.toLowerCase().includes(searchTerm) ||
                    crop.variety.toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter) {
                filteredCrops = filteredCrops.filter(crop => crop.status === statusFilter);
            }
            
            if (fieldFilter) {
                filteredCrops = filteredCrops.filter(crop => crop.field === fieldFilter);
            }
            
            // Update display with filtered crops
            const container = document.getElementById('cropsContainer');
            const noCropsMessage = document.getElementById('noCropsMessage');
            
            if (filteredCrops.length === 0) {
                container.innerHTML = '';
                noCropsMessage.style.display = 'block';
                return;
            }
            
            noCropsMessage.style.display = 'none';
            container.innerHTML = '';
            
            filteredCrops.forEach(crop => {
                const cropCard = createCropCard(crop);
                container.appendChild(cropCard);
            });
        }

        function showAlert(message, type) {
            // Create and show alert
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(alertDiv);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 3000);
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        document.getElementById('fieldFilter').addEventListener('change', applyFilters);
    </script>
</body>
</html>
