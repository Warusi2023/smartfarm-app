<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Role Management - SmartFarm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="js/user-roles.js"></script>
    <style>
        .role-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .role-badge {
            font-size: 0.8rem;
            padding: 4px 8px;
        }
        .feature-list {
            max-height: 200px;
            overflow-y: auto;
        }
        .current-user {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .permission-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .permission-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #007bff;
        }
        .owner-only { border-left-color: #ffc107; }
        .admin-only { border-left-color: #dc3545; }
        .user-only { border-left-color: #28a745; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1><i class="fas fa-shield-alt me-2"></i>Role Management</h1>
        <p class="lead">Control user access and permissions for SmartFarm features</p>

        <!-- Current User Status -->
        <div class="current-user">
            <h3><i class="fas fa-user me-2"></i>Current User Status</h3>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Role:</strong> <span id="currentRole">Loading...</span></p>
                    <p><strong>Email:</strong> <span id="currentEmail">Loading...</span></p>
                    <p><strong>Is Owner:</strong> <span id="isOwner">Loading...</span></p>
                </div>
                <div class="col-md-6">
                    <p><strong>Permissions:</strong></p>
                    <div id="currentPermissions"></div>
                </div>
            </div>
        </div>

        <!-- Role Controls -->
        <div class="role-card">
            <h3><i class="fas fa-cogs me-2"></i>Role Controls</h3>
            <p class="text-muted">Use these controls to test different user roles (development only)</p>
            
            <div class="row">
                <div class="col-md-3">
                    <button class="btn btn-warning w-100" onclick="setUserRole('owner')">
                        <i class="fas fa-crown me-2"></i>Set as Owner
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-danger w-100" onclick="setUserRole('admin')">
                        <i class="fas fa-user-shield me-2"></i>Set as Admin
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-success w-100" onclick="setUserRole('user')">
                        <i class="fas fa-user me-2"></i>Set as User
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-secondary w-100" onclick="setUserRole('guest')">
                        <i class="fas fa-user-slash me-2"></i>Set as Guest
                    </button>
                </div>
            </div>
            
            <div class="mt-3">
                <button class="btn btn-outline-primary me-2" onclick="enableOwnerMode()">
                    <i class="fas fa-unlock me-2"></i>Enable Owner Mode
                </button>
                <button class="btn btn-outline-secondary" onclick="disableOwnerMode()">
                    <i class="fas fa-lock me-2"></i>Disable Owner Mode
                </button>
            </div>
        </div>

        <!-- Role Definitions -->
        <div class="role-card">
            <h3><i class="fas fa-list me-2"></i>Role Definitions</h3>
            <div class="permission-grid">
                <div class="permission-card owner-only">
                    <h5><i class="fas fa-crown me-2"></i>Owner</h5>
                    <p class="text-muted">Full access to all features</p>
                    <div class="feature-list">
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check text-success me-2"></i>All debugging tools</li>
                            <li><i class="fas fa-check text-success me-2"></i>Analytics dashboard</li>
                            <li><i class="fas fa-check text-success me-2"></i>Admin features</li>
                            <li><i class="fas fa-check text-success me-2"></i>Crop management</li>
                            <li><i class="fas fa-check text-success me-2"></i>Livestock management</li>
                            <li><i class="fas fa-check text-success me-2"></i>User management</li>
                            <li><i class="fas fa-check text-success me-2"></i>System settings</li>
                        </ul>
                    </div>
                </div>
                
                <div class="permission-card admin-only">
                    <h5><i class="fas fa-user-shield me-2"></i>Admin</h5>
                    <p class="text-muted">Administrative access</p>
                    <div class="feature-list">
                        <ul class="list-unstyled">
                            <li><i class="fas fa-times text-danger me-2"></i>Debugging tools</li>
                            <li><i class="fas fa-check text-success me-2"></i>Analytics dashboard</li>
                            <li><i class="fas fa-check text-success me-2"></i>Admin features</li>
                            <li><i class="fas fa-check text-success me-2"></i>Crop management</li>
                            <li><i class="fas fa-check text-success me-2"></i>Livestock management</li>
                            <li><i class="fas fa-check text-success me-2"></i>User management</li>
                            <li><i class="fas fa-times text-danger me-2"></i>System settings</li>
                        </ul>
                    </div>
                </div>
                
                <div class="permission-card user-only">
                    <h5><i class="fas fa-user me-2"></i>User</h5>
                    <p class="text-muted">Standard user access</p>
                    <div class="feature-list">
                        <ul class="list-unstyled">
                            <li><i class="fas fa-times text-danger me-2"></i>Debugging tools</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Analytics dashboard</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Admin features</li>
                            <li><i class="fas fa-check text-success me-2"></i>Crop management</li>
                            <li><i class="fas fa-check text-success me-2"></i>Livestock management</li>
                            <li><i class="fas fa-check text-success me-2"></i>Basic features</li>
                            <li><i class="fas fa-times text-danger me-2"></i>System settings</li>
                        </ul>
                    </div>
                </div>
                
                <div class="permission-card">
                    <h5><i class="fas fa-user-slash me-2"></i>Guest</h5>
                    <p class="text-muted">Limited access</p>
                    <div class="feature-list">
                        <ul class="list-unstyled">
                            <li><i class="fas fa-times text-danger me-2"></i>Debugging tools</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Analytics dashboard</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Admin features</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Basic features</li>
                            <li><i class="fas fa-check text-success me-2"></i>View only</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feature Access Matrix -->
        <div class="role-card">
            <h3><i class="fas fa-table me-2"></i>Feature Access Matrix</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th class="text-center">Owner</th>
                            <th class="text-center">Admin</th>
                            <th class="text-center">User</th>
                            <th class="text-center">Guest</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><i class="fas fa-bug me-2"></i>Button Debugger</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-bug me-2"></i>Ads Testing</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-chart-line me-2"></i>Ads Analytics</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-cogs me-2"></i>Admin Panel</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-seedling me-2"></i>Crop Management</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-paw me-2"></i>Livestock Management</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-times text-danger"></i></td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-eye me-2"></i>View Dashboard</td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                            <td class="text-center"><i class="fas fa-check text-success"></i></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Owner Configuration -->
        <div class="role-card">
            <h3><i class="fas fa-crown me-2"></i>Owner Configuration</h3>
            <p class="text-muted">Configure who has owner access to SmartFarm</p>
            
            <div class="row">
                <div class="col-md-6">
                    <h5>Owner Email Addresses</h5>
                    <div class="alert alert-info">
                        <strong>Current Owner Emails:</strong>
                        <ul class="mb-0 mt-2">
                            <li>warusi2023@gmail.com</li>
                            <li>admin@smartfarm-app.com</li>
                            <li>owner@smartfarm-app.com</li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5>Development Access</h5>
                    <div class="alert alert-warning">
                        <strong>Development Mode:</strong><br>
                        Owner mode can be enabled for development/testing purposes using the controls above.
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Notes -->
        <div class="role-card">
            <h3><i class="fas fa-shield-alt me-2"></i>Security Notes</h3>
            <div class="alert alert-warning">
                <h5><i class="fas fa-exclamation-triangle me-2"></i>Important Security Information</h5>
                <ul class="mb-0">
                    <li><strong>Owner Access:</strong> Only you (the project owner) should have owner-level access</li>
                    <li><strong>Email Verification:</strong> Owner status is determined by email address</li>
                    <li><strong>Development Mode:</strong> Owner mode can be enabled for testing but should be disabled in production</li>
                    <li><strong>Role Persistence:</strong> User roles are stored in localStorage and persist across sessions</li>
                    <li><strong>Feature Protection:</strong> Debugging and testing tools are hidden from regular users</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Update current user info
        function updateCurrentUserInfo() {
            const roleInfo = getRoleInfo();
            
            document.getElementById('currentRole').textContent = roleInfo.role.toUpperCase();
            document.getElementById('currentEmail').textContent = roleInfo.email || 'Not logged in';
            document.getElementById('isOwner').textContent = roleInfo.isOwner ? 'Yes' : 'No';
            
            const permissionsDiv = document.getElementById('currentPermissions');
            permissionsDiv.innerHTML = roleInfo.permissions.map(permission => 
                `<span class="badge bg-primary me-1">${permission}</span>`
            ).join('');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentUserInfo();
            
            // Update info when role changes
            setInterval(updateCurrentUserInfo, 1000);
        });

        // Override role functions to update display
        const originalSetUserRole = window.setUserRole;
        window.setUserRole = function(role) {
            originalSetUserRole(role);
            updateCurrentUserInfo();
        };

        const originalEnableOwnerMode = window.enableOwnerMode;
        window.enableOwnerMode = function() {
            originalEnableOwnerMode();
            updateCurrentUserInfo();
        };

        const originalDisableOwnerMode = window.disableOwnerMode;
        window.disableOwnerMode = function() {
            originalDisableOwnerMode();
            updateCurrentUserInfo();
        };
    </script>
</body>
</html>
